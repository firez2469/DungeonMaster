function displayLogin(){var e=document.getElementById("login-box"),t=document.getElementById("save"),l=window.sessionStorage.getItem("login"),n=document.getElementById("loggedInAs"),o=document.getElementById("logout");console.log("null"==l),null==l||"null"==l||"undefined"==l?(l="",n.innerText="Not logged in",o.style.visibility="hidden",t.style.visibility="hidden"):(e&&(e.style.visibility="hidden",window.location="/Levels.html"),n.innerText="Logged in as: "+l,o.style.visibility="visible"),o.onclick=function(){window.sessionStorage.setItem("login",void 0),window.location="/login.html"}}function deleteElement(e){var t=e.split("delete")[1];t>0&&document.getElementById("levelItem"+t).remove()}function enterLvlElement(e){window.sessionStorage.setItem("levelLoad",e);var t=e.split("enterlvl")[1];"enter_lvl"==e&&(t="");var l=document.getElementById("levelItem"+t),n=l.querySelector("#level_name").innerHTML,o=l.querySelector("#level_desc").innerHTML;window.sessionStorage.setItem("levelName",n),window.sessionStorage.setItem("levelDesc",o),window.location="Level.html"}function createNewLevel(){var e=document.getElementById("levelItem").cloneNode(!0);return e.removeAttribute("id"),e.id="levelItem"+elementCount,delBtn=e.querySelector("#delete"),delBtn.id="delete"+elementCount,delBtn.onclick=function(e){deleteElement(e.target.id)},enterBtn=e.querySelector("#enter_lvl"),enterBtn&&(enterBtn.id="enterlvl"+elementCount,enterBtn.onclick=function(e){enterLvlElement(e.target.id)}),document.getElementById("levels")&&(e.querySelector("#level_name").innerHTML="New Level "+elementCount,e.querySelector("#level_desc").innerHTML="Level description..."),document.getElementById("body").appendChild(e),elementCount++,e}var inDoc,element;(elementCount=1,loadedLevelsCount=0,heldData=[],displayLogin(),inDoc=!!document.getElementById("createNew"))&&((element=document.getElementById("createNew")).onclick=function(e){createNewLevel()});(inDoc=!!document.getElementById("save"))&&((element=document.getElementById("save")).onclick=function(e){save()});if(document.getElementById("levels")){var initEnterBtn=document.getElementById("enter_lvl");initEnterBtn.onclick=function(e){enterLvlElement(e.target.id)}}if(document.getElementById("level")){var name=window.sessionStorage.getItem("levelName"),desc=window.sessionStorage.getItem("levelDesc"),id=window.sessionStorage.getItem("levelLoad"),idNum=id.split("enterlvl")[1];0==!!idNum&&(idNum=0);var levelTitle=document.getElementById("level");levelTitle.value+=name;var levelDesc=document.getElementById("level_desc");levelDesc.value=desc}function contains(e,t){matchInd=0,matchLength=0,match=!1;for(let l=0;l<e.length;l++)if(match)if(e[l]==t[matchLength])matchLength+=1;else{if(matchLength==t.length)return!0;match=!1}else match=e[l]==t[0],matchInd=0,matchLength=1;return match}function parseArray(e){endData=[],lines=e.split("\n"),curHeader="__Default__",headerData=[];for(let e=0;e<lines.length;e++)contains(lines[e],"__")?(endData.push({Header:curHeader,Data:headerData}),headerData=[],curHeader=lines[e]):headerData.push(lines[e]);return endData.length>0&&console.log(endData[0]),endData}function saveTemplate(e){var t="";return name=e.querySelector("#template_name").value,desc=e.querySelector("#template_desc").value,align=e.querySelector("#template_alignment").value,size=e.querySelector("#template_size").value,ac=e.querySelector("#template_ac").value,hp=e.querySelector("#template_hp").value,speed=e.querySelector("#template_speed").value,str=e.querySelector("#template_str").value,dex=e.querySelector("#template_dex").value,con=e.querySelector("#template_con").value,int=e.querySelector("#template_int").value,wis=e.querySelector("#template_wis").value,cha=e.querySelector("#template_cha").value,skills=e.querySelector("#template_skills").value,abilities=e.querySelector("#template_abilities").value,spells=e.querySelector("#template_spells").value,t+="__Template__:\n",t+="#template_name:"+name+"\n",t+="#template_desc:"+desc+"\n",t+="#template_alignment:"+align+"\n",t+="#template_size:"+size+"\n",t+="#template_ac:"+ac+"\n",t+="#template_hp:"+hp+"\n",t+="#template_speed:"+speed+"\n",t+="#template_str:"+str+"\n",t+="#template_dex:"+dex+"\n",t+="#template_con:"+con+"\n",t+="#template_int:"+int+"\n",t+="#template_wis:"+wis+"\n",t+="#template_cha:"+cha+"\n",t+="#template_skills:"+skills+"\n",t+="#template_abilities:"+abilities+"\n",t+="#template_spells:"+spells+"\n",t+="__Default__\n",console.log("Text:"+t),t}function saveLevelCard(e){var t="";return name=e.querySelector("#level_name").innerHTML,desc=e.querySelector("#level_desc").innerHTML,t+="__Level__:\n",t+="#level_name:"+name+"\n",t+="#level_desc:"+desc+"\n",t+="__Default__\n"}function saveLevel(){var e="";return name=document.getElementById("level").value,desc=document.getElementById("level_desc").value,e+="__Level__:\n",e+="#level_name:"+name+"\n",e+="#level_desc:"+desc+"\n",e+="__Default__\n"}function save(){var e=document.createElement("a");if(text="Hello world this is a file!",console.log("Saving..."),document.getElementById("templates")){for(text="",curIndex=1,clone=document.getElementById("levelItem"),text+=saveTemplate(clone),console.log("Is Valid?:"+curIndex+":"+!!document.getElementById("levelItem"+curIndex));document.getElementById("levelItem"+curIndex);)clone=document.getElementById("levelItem"+curIndex),text+=saveTemplate(clone),curIndex++;e.href=window.URL.createObjectURL(new Blob([text],{type:"text/plain"})),e.download="save.txt",e.click(),console.log("Saved!")}else if(document.getElementById("levels")){for(text="",curIndex=1,clone=document.getElementById("levelItem"),text+=saveLevelCard(clone);document.getElementById("levelItem"+curIndex);)clone=document.getElementById("levelItem"+curIndex),text+=saveLevelCard(clone),curIndex++;e.href=window.URL.createObjectURL(new Blob([text],{type:"text/plain"})),e.download="save_levels.txt",e.click(),console.log("Saved!")}else document.getElementById("level")&&(text="",text+=saveLevel(),e.href=window.URL.createObjectURL(new Blob([text],{type:"text/plain"})),e.download="save_level.txt",e.click(),console.log("Saved!"))}function load(e){if(loaded<=1){if(outData=parseArray(e),document.getElementById("levels"))for(let e=0;e<outData.length;e++)console.log("Data:"+outData[e].Header),"__Level__:"==outData[e].Header&&(console.log("LEVELCARD!!!"),0!=loadedLevelsCount?(clone=createNewLevel(),applyToCloneLevels(clone,outData[e].Data)):(orig=document.getElementById("levelItem"),console.log(orig),applyToCloneLevels(orig,outData[e].Data)),loadedLevelsCount++),console.log(outData[e].Header);if(document.getElementById("templates"))for(let e=0;e<outData.length;e++)"__Template__:"==outData[e].Header&&(console.log("TEMPLATE!!!"),0!=loadedLevelsCount?(clone=createNewLevel(),applyToCloneTemplate(clone,outData[e].Data)):(orig=document.getElementById("levelItem"),applyToCloneTemplate(orig,outData[e].Data)),loadedLevelsCount++),console.log(outData[e].Header);document.getElementById("listTemplates")}loaded+=1}function applyToCloneTemplate(e,t){console.log("Applying data:"+t);for(let o=0;o<t.length;o++){var l=t[o].split(":")[0],n=t[o].split(":")[1];console.log("Read{"+l+":"+n+"}"),e.querySelector(l).value=n}}function applyToCloneLevels(e,t){console.log("Applying level data:"+t);for(let o=0;o<t.length;o++){var l=t[o].split(":")[0],n=t[o].split(":")[1];console.log("Read{"+l+":"+n+"}"),e.querySelector(l).innerHTML=n}}function mode(e){console.log("Entering mode:"+e),"create"==e?(document.getElementById("spawnable_card").style.visibility="visible",document.getElementById("create_mode_btn").disabled=!0,document.getElementById("edit_mode_btn").disabled=!1):(document.getElementById("spawnable_card").style.visibility="hidden",document.getElementById("create_mode_btn").disabled=!1,document.getElementById("edit_mode_btn").disabled=!0)}function deleteAtPath(e){delvalue(e)}loaded=0,document.getElementById("level")&&(document.getElementById("create_mode_btn").disabled=!0);