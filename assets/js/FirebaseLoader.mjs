import{initializeApp as e}from"https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js";import{getAnalytics as t}from"https://www.gstatic.com/firebasejs/9.8.2/firebase-analytics.js";import{getDatabase as l,ref as n,set as o,push as a,update as s,get as r,child as i}from"https://www.gstatic.com/firebasejs/9.8.2/firebase-database.js";const m=e({apiKey:"AIzaSyAOGv3RJqw5T4pPAGDfvwRhoYyI6U5omWs",authDomain:"test-1-f3a0b.firebaseapp.com",databaseURL:"https://test-1-f3a0b.firebaseio.com",projectId:"test-1-f3a0b",storageBucket:"test-1-f3a0b.appspot.com",messagingSenderId:"800825612650",appId:"1:800825612650:web:817df1bd2d25755fd12d13",measurementId:"G-KVWPQ6GHFW"}),c=(t(m),l(m)),u=n(l());var d,v=[],g=[],p=!1,y=window.sessionStorage.getItem("login");export{g as entityData};if(document.getElementById("save"))if(document.getElementById("templates"))_(y,"templates");else if(document.getElementById("levels"))_(y,"levels");else if(document.getElementById("level")){var f=window.sessionStorage.getItem("levelLoad");""==(f=f.split("enter_lvl")[1])&&(f=0),console.log("Loading level:"+f),_(y,"levels/"+f),_(y,"templates","-level")}function I(e,t,l){console.log("Saving template");var a=t.querySelector("#template_name").value;console.log("Found value:"+a);var s=t.querySelector("#template_desc").value,r=t.querySelector("#template_alignment").value,i=t.querySelector("#template_size").value,m=t.querySelector("#template_ac").value,u=t.querySelector("#template_hp").value,d=t.querySelector("#template_speed").value,v=t.querySelector("#template_str").value,g=t.querySelector("#template_dex").value,p=t.querySelector("#template_con").value,y=t.querySelector("#template_int").value,f=t.querySelector("#template_wis").value,I=t.querySelector("#template_cha").value,S=t.querySelector("#template_skills").value,w=t.querySelector("#template_abilities").value,_=t.querySelector("#template_spells").value;console.log("Setting:"+a),o(n(c,"/"+e+"/templates/"+l+"/"),{name:a,desc:s,align:r,size:i,ac:m,hp:u,speed:d,str:v,dex:g,con:p,int:y,wis:f,cha:I,skills:S,abilities:w,spells:_})}function S(e,t,l){console.log("Saving Level");document.getElementById("levels");if(!!document.getElementById("level"))var a=document.getElementById("level").value;var s=document.getElementById("level_desc").value;console.log("Entity Data:"),console.log(g);var r=window.sessionStorage.getItem("level_length"),i=window.sessionStorage.getItem("fields").split(",");g=new Array(r);for(var m=0;m<r;m++){g[m]={};for(var u=0;u<i.length;u++){var d=window.sessionStorage.getItem("level_entity"+m+i[u]);g[m][i[u]]=d}}0==g[0]&&(g={}),o(n(c,"/"+e+"/levels/"+l+"/"),{name:a,desc:s,entityData:g})}function w(e,t,l){console.log("Saving levels");var a=t.querySelector("#level_name").innerHTML,s=t.querySelector("#level_desc").innerHTML;o(n(c,"/"+e+"/levels/"+l+"/name/"),a),o(n(c,"/"+e+"/levels/"+l+"/desc/"),s)}function _(e,t,l){return console.log("Path:/"+e+"/"+t),console.log("Optional:"+l),r(i(u,"/"+e+"/"+t)).then((e=>{if(e.exists()){var n=e.val();console.log("TYPE:"+t);var o=0;for(const[e,T]of Object.entries(n))if("templates"==t&&null==l){if("temp_a"!=e){e>0&&createNewLevel();var a=T.name,s=T.desc,r=T.align,i=T.size,m=T.ac,c=T.hp,u=T.speed,d=T.str,y=T.dex,f=T.con,I=T.int,S=T.wis,w=T.cha,_=T.skills,E=T.abilities,B=T.spells,b=e;0==e&&(b=""),(q=document.getElementById("levelItem"+b)).querySelector("#template_name").value=a,console.log("Found value:"+a),q.querySelector("#template_desc").value=s,q.querySelector("#template_alignment").value=r,q.querySelector("#template_size").value=i,q.querySelector("#template_ac").value=m,q.querySelector("#template_hp").value=c,q.querySelector("#template_speed").value=u,q.querySelector("#template_str").value=d,q.querySelector("#template_dex").value=y,q.querySelector("#template_con").value=f,q.querySelector("#template_int").value=I,q.querySelector("#template_wis").value=S,q.querySelector("#template_cha").value=w,q.querySelector("#template_skills").value=_,q.querySelector("#template_abilities").value=E,q.querySelector("#template_spells").value=B,console.log("value:"+T.name)}}else if("levels"==t&&null==l){if("na"!=e){console.log("Level "+o+":"+T.name);a=T.name,s=T.desc;var q,h=o;0==h?h="":createNewLevel(),(q=document.getElementById("levelItem"+h)).querySelector("#level_name").innerHTML=a,q.querySelector("#level_desc").innerHTML=s}o++}else if(t.includes("level")&&null==l){window.sessionStorage.getItem("levelLoad");if("name"==e)document.getElementById("level").value=T;else if("entityData"==e)g=T,p=!0,console.log("Set entity Data pog!");else{var L="level_"+e;document.getElementById(L).value=T}console.log("key:"+e)}else if("templates"==t&&"-level"==l&&"temp_a"!=e){b=e;0==e&&(b=""),v.push(T),console.log("value:"+T.name)}return p=!0,e.val()}return console.log("No data available"),null})).catch((e=>{console.error(e)}))}d="Bungee",r(i(u,"/"+"/users")).then((e=>{if(e.exists()){var t=e.val();for(const[e,l]of Object.entries(t))e==d&&console.log("key:"+e,"value:"+l);return e.val()}return console.log("No data available"),null})).catch((e=>{console.error(e)})),document.getElementById("save").onclick=function(){console.log("Saving!!!"),function(){var e=!!document.getElementById("templates"),t=!!document.getElementById("levels"),l=!!document.getElementById("level");if(document.getElementById("templates")||l){var a=document.getElementById("levelItem");e?I(y,a,0):(l||t)&&(r="enter_lvl"==(r=window.sessionStorage.getItem("levelLoad"))?0:r.split("enterlvl")[1],S(y,0,r));for(var s=1;document.getElementById("levelItem"+s);){if(a=document.getElementById("levelItem"+s),e)I(y,a,s);else if(l||t){var r=window.sessionStorage.getItem("levelLoad");console.log("Saving for level:"+r),S(y,0,r)}s++}if(document.getElementById("templates"))for(let e=1;e<100;e++)document.getElementById("levelItem"+e)?I(y,document.getElementById("levelItem"+e),e):o(n(c,"/"+y+"/templates/"+e),{})}else if(t){if(document.getElementById("levels"))for(let e=1;e<100;e++)document.getElementById("levelItem"+e)?w(y,document.getElementById("levelItem"+e),e):o(n(c,"/"+y+"/levels/"+e),{});var i=document.getElementById("levelItem");w(y,i,0)}}()},console.log("NO Crash"),window.onload=function(){(document.getElementById("templates")||document.getElementById("level"))&&r(i(u,"/"+y+"/templates")).then((e=>{if(e.exists()){var t=e.val(),l=0;for(const[e,o]of Object.entries(t))if("na"!=o){if(0==l)document.getElementById("template0_btn"),(n=document.getElementById("template0")).querySelector("#template_name").innerHTML=o.name;else{var n;console.log("Loading:"+e);let t=l;(n=document.getElementById("template0").cloneNode(!0)).id="template"+t,n.querySelector("#template0_btn").id="template"+t+"_btn",n.querySelector("#template_name").innerHTML=o.name,document.getElementById("spawnable").appendChild(n)}l++}return e.val()}return console.log("Template No data available"),null})).catch((e=>{console.error(e)}))};export function createNewObject(e){}export function loadObjectData(e,t,l){}export function setEntityData(e){window.sessionStorage.setItem("level_length",e.length),g=[];for(var t="",l=0;l<e.length;l++){for(var n in e[l]){var o=e[l][n];let a=o;"img"==n&&"img"==n&&(a="https://pic.onlinewebfonts.com/svg/img_235012.png"==o.src?"player":"enemy"),window.sessionStorage.setItem("level_entity"+l+n,a),0==l&&(t+=n+",")}g.push(e[l])}t=t.substring(0,t.length-1),window.sessionStorage.setItem("fields",t),g=e}export function getTemplates(){return v}export function loadedPreviousEntityData(e){return p&&g,[p,g]}!function(){if(console.log("Starting"),!!document.getElementById("login-box")){var e="LOGIN",t=document.getElementById("register-link"),l=document.getElementById("submit-id-submit"),n=document.getElementById("settingTitle"),o=document.getElementById("email"),a=document.getElementById("password"),s=document.getElementById("errorMsg");function m(){var t,l,n=o.value,m=(t=a.value,(l=new jsSHA("SHA-512","TEXT",{numRounds:1})).update(t),l.getHash("HEX"));if(console.log(m),"LOGIN"==e)return r(i(u,"/users")).then((e=>{if(e.exists()){var t=e.val(),l=!1;for(const[e,s]of Object.entries(t))if("Bungee"!=e){var o=s.name,a=s.password;o==n&&a==m&&(console.log("Logged in as "+o+"!"),l=!0,window.sessionStorage.setItem("login",o.replace("@","_").replace(".","_")),window.sessionStorage.setItem("loggedIn","true"),location.reload(!0))}return l||(console.log("Incorrect username or password"),s.style.display="block",s.innerText="Incorrect username or password"),e.val()}return console.log("No data available"),null})).catch((e=>{console.error(e)}));"SIGNUP"==e&&alert("Currently Sign up is disabled. Go to form to request access to server.")}s.style.display="none",t.onclick=function(){"LOGIN"==e?(e="SIGNUP",n.innerHTML="Sign Up",t.innerHTML="Login!",t.parentElement.firstChild.data="Already have an account?",l.innerHTML="Sign up"):(e="LOGIN",n.innerHTML="Login",t.innerHTML="Sign Up!",t.parentElement.firstChild.data="Don't have an account?",l.innerHTML="Login")},l.onsubmit=function(){m()},l.onclick=function(){m()}}}();